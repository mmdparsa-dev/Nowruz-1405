<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8" />
<title>شمارش معکوس عید نوروز ۱۴۰۵</title>
<link rel="stylesheet" href="font.css" />
<style>
body {
  margin: 0;
  font-family: 'Vazir Variable', sans-serif;
  background: linear-gradient(135deg, #731616 0%, #A82A2A 60%, #D84545 100%);
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
  color: #fff;
  user-select: none;
}

.container {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20px;
  padding: 30px 40px;
  border-radius: 50px;
  background: rgba(255, 255, 255, 0.076);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  box-shadow: 0 8px 40px rgba(0,0,0,0.35);
  border: 1px solid rgba(255,255,255,0.3);
}

#link {
  position: fixed;
  bottom: -150px;
  left: 50%;
  transform: translateX(-50%);
  padding: 5px 10px;
  font-size: 20px;
  font-weight: 500;
  color: #fff;
  text-decoration: none;
  border-radius: 15px;
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  border: 0.025px solid rgba(255, 255, 255, 0.2);
  z-index: 9999;
  text-align: center;
  transition: 0.3s;
}

.haftsine-icon { width: 300px; height: auto; }

.countdown {
  display: flex;
  align-items: flex-end;
  justify-content: center;
  gap: clamp(2rem, 6vw, 8rem);
  font-weight: 800;
  font-size: clamp(2rem, 5vw, 3.2rem);
  padding: 16px 20px;
}

.time-unit {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.2rem;
  width: 50px;
}

.time-label {
  font-size: clamp(0.9rem, 2.2vw, 1.05rem);
  font-weight: 700;
  opacity: 0.95;
}

.time-value {
  font-size: clamp(2.4rem, 6vw, 3.4rem);
  line-height: 1;
  transition: transform 0.5s ease, opacity 0.5s ease, filter 0.5s ease;
  letter-spacing: 0.04em;
  text-shadow: 0 0 3px rgba(0, 0, 0, 0.5);
}

.countdown-title-box {
  font-weight: 600;
  font-size: clamp(1.2rem, 3.2vw, 1.8rem);
  padding: 18px 32px;
  border-radius: 999px;
  background: rgba(0, 0, 0, 0.1);
  backdrop-filter: blur(8px);
  text-align: center;
  box-shadow: 0 4px 15px rgba(0,0,0,0.25);
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  border: 0.025px solid rgba(255, 255, 255, 0.2);
}

@media (max-width: 420px) {
  .haftsine-icon { width: 220px; }
}

/* پیام فول‌اسکرین با Motion Blur واقعی و ورود از بالا */
#fullscreen-msg {
  position: fixed;
  top: 0;
  left: 50%;
  transform: translateX(-50%) translateY(-300%);
  background: rgba(255, 255, 255, 0.076);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  box-shadow: 0 8px 40px rgba(0,0,0,0.35);
  border: 1px solid rgba(255,255,255,0.3);
  color: #fff;
  padding: 20px 30px;
  font-size: 1.3rem;
  font-weight: 700;
  border-radius: 15px;
  z-index: 10000;
  text-align: center;
  opacity: 0;
  cursor: pointer;
  filter: blur(15px);
  transition: transform 0.6s cubic-bezier(0.25,0.46,0.45,0.94), opacity 0.5s ease, filter 0.5s ease;
}
</style>
</head>
<body>
<div class="container" aria-label="شمارش معکوس عید نوروز ۱۴۰۵">
  <img src="Icon(images)/haft-sin.png" alt="هفت‌سین" class="haftsine-icon" />
  <div class="countdown" aria-label="شمارش معکوس تا تحویل سال ۱۴۰۵">
    <div class="time-unit" aria-label="ثانیه">
      <div id="seconds" class="time-value" aria-live="polite">۰۰</div>
      <div class="time-label">ثانیه</div>
    </div>
    <div class="time-unit" aria-label="دقیقه">
      <div id="minutes" class="time-value" aria-live="polite">۰۰</div>
      <div class="time-label">دقیقه</div>
    </div>
    <div class="time-unit" aria-label="ساعت">
      <div id="hours" class="time-value" aria-live="polite">۰۰</div>
      <div class="time-label">ساعت</div>
    </div>
    <div class="time-unit" aria-label="روز">
      <div id="days" class="time-value" aria-live="polite">۰۰</div>
      <div class="time-label">روز</div>
    </div>
    <div class="time-unit" aria-label="ماه">
      <div id="months" class="time-value" aria-live="polite">۰۰</div>
      <div class="time-label">ماه</div>
    </div>
  </div>
  <a href="https://github.com/mmdparsa-dev/Nowruz-1405-" target="_blank" id="link">مشاهده پروژه در GitHub</a>
  <div class="countdown-title-box">زمــــان باقـــــی‌مــــانــــده تا تحویـــــل ســــال ۱۴۰۵</div>
</div>

<!-- پیام فول‌اسکرین -->
<div id="fullscreen-msg">برای full screen شدن کلیک کنید</div>

<script>
// تبدیل اعداد به فارسی
function toPersianDigits(str) {
  return str.toString().replace(/\d/g, d => '۰۱۲۳۴۵۶۷۸۹'[d]);
}

// بررسی کبیسه شمسی
function isLeapJalali(year) {
  const breaks = [-61, 9, 38, 199, 426, 686, 756, 818, 1111, 1181, 1210, 1635, 2060, 2097, 2192, 2262, 2324, 2394, 2456, 3178];
  let n = 0;
  for (let i = 0; i < breaks.length; i++) {
    if (year < breaks[i]) break;
    n = breaks[i];
  }
  return ((year - n) % 33) % 4 === 0;
}

// تبدیل میلادی به شمسی
function gregorianToJalali(gy, gm, gd) {
  let g_d_m = [0,31,59,90,120,151,181,212,243,273,304,334];
  let jy = gy - 621;
  let gy2 = (gm > 2) ? (gy + 1) : gy;
  let days = 365*(gy-1600) + Math.floor((gy-1600+3)/4) - Math.floor((gy-1600+99)/100) + Math.floor((gy-1600+399)/400) + gd + g_d_m[gm-1] - 1 - 79;
  let j_np = Math.floor(days / 12053);
  days %= 12053;
  jy = 979 + 33*j_np + 4*Math.floor(days/1461);
  days %= 1461;
  if (days >= 366) {
    jy += Math.floor((days-1)/365);
    days = (days-1)%365;
  }
  let jm = (days < 186) ? 1 + Math.floor(days/31) : 7 + Math.floor((days-186)/30);
  let jd = 1 + ((days < 186) ? (days%31) : ((days-186)%30));
  return [jy, jm, jd];
}

// تعداد روزهای هر ماه شمسی
function daysInJalaliMonth(year, month) {
  if (month <= 6) return 31;
  if (month <= 11) return 30;
  return isLeapJalali(year) ? 30 : 29;
}

// تاریخ هدف تحویل سال ۱۴۰۵
const targetUtc = new Date(Date.UTC(2026,2,20,18,16,30));

const elems = {
  months:  document.getElementById('months'),
  days:    document.getElementById('days'),
  hours:   document.getElementById('hours'),
  minutes: document.getElementById('minutes'),
  seconds: document.getElementById('seconds'),
};

const prevValues = {};

function animateChange(elem, newVal) {
  if (!elem || prevValues[elem.id] === newVal) return;
  prevValues[elem.id] = newVal;

  elem.style.transform = 'translateY(-100%)';
  elem.style.opacity   = '0';
  elem.style.filter    = 'blur(6px)';

  setTimeout(() => {
    elem.textContent = newVal;
    elem.style.transition = 'none';
    elem.style.transform  = 'translateY(100%)';
    elem.style.opacity    = '0';
    elem.style.filter     = 'blur(2px)';
    void elem.offsetWidth;

    elem.style.transition = 'transform 1s ease, opacity 1s ease, filter 1s ease';
    elem.style.transform  = 'translateY(0)';
    elem.style.opacity    = '1';
    elem.style.filter     = 'blur(0)';
  }, 500);
}

function update() {
  const now = new Date();
  const diff = targetUtc - now;
  if (diff < 0) return;

  const totalSeconds = Math.floor(diff / 1000);
  const seconds = totalSeconds % 60;
  const totalMinutes = Math.floor(totalSeconds / 60);
  const minutes = totalMinutes % 60;
  const totalHours = Math.floor(totalMinutes / 60);
  const hours = totalHours % 24;
  const totalDays = Math.floor(totalHours / 24);

  const [jyNow, jmNow, jdNow] = gregorianToJalali(now.getUTCFullYear(), now.getUTCMonth()+1, now.getUTCDate());
  const [jyTarget, jmTarget, jdTarget] = gregorianToJalali(targetUtc.getUTCFullYear(), targetUtc.getUTCMonth()+1, targetUtc.getUTCDate());

  let months = (jyTarget - jyNow) * 12 + (jmTarget - jmNow);
  let days = jdTarget - jdNow;
  if (days < 0) {
    months -= 1;
    let prevMonth = jmTarget - 1;
    let prevYear = jyTarget;
    if (prevMonth === 0) { prevMonth = 12; prevYear -= 1; }
    days += daysInJalaliMonth(prevYear, prevMonth);
  }

  animateChange(elems.months, toPersianDigits(String(months).padStart(2,'0')));
  animateChange(elems.days, toPersianDigits(String(days).padStart(2,'0')));
  animateChange(elems.hours, toPersianDigits(String(hours).padStart(2,'0')));
  animateChange(elems.minutes, toPersianDigits(String(minutes).padStart(2,'0')));
  animateChange(elems.seconds, toPersianDigits(String(seconds).padStart(2,'0')));
}

setInterval(update, 250);
update();

// پیام فول‌اسکرین Motion Blur
const msg = document.getElementById('fullscreen-msg');
let autoClose;

// ورود Motion Blur از بالا
setTimeout(() => {
  msg.style.transform = "translateX(-50%) translateY(50%)";
  msg.style.opacity = "1";
  msg.style.filter = "blur(0)";
}, 100);

// خروج Motion Blur
function hideMessage() {
  msg.style.opacity = "0";
  msg.style.filter = "blur(15px)";
  msg.style.transform = "translateX(-50%) translateY(-300%)";
  setTimeout(() => msg.remove(), 600);
  clearTimeout(autoClose);
}

// خودکار بعد ۳ ثانیه
autoClose = setTimeout(hideMessage, 3000);

// کلیک → فول‌اسکرین + حذف سریع
msg.addEventListener('click', () => {
  const elem = document.documentElement;
  if (elem.requestFullscreen) elem.requestFullscreen();
  else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
  else if (elem.msRequestFullscreen) elem.msRequestFullscreen();
  hideMessage();
});
</script>
</body>
</html>
